<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unternehmensbewertung</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #ffffff 100%); /* Brighter background */
            color: #333333; /* Dark gray text from SPP */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }
        h1 {
            font-size: 2rem; /* Smaller title */
            font-weight: 300;
            margin: 40px 0 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #00a859; /* SPP green */
            text-shadow: 0 1px 5px rgba(0, 168, 89, 0.2);
        }
        .container {
            width: 95%;
            max-width: 1000px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        .container:hover {
            transform: translateY(-5px);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 14px;
            text-align: right;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        th {
            text-align: left;
            font-weight: 400;
            color: #666666;
        }
        input[type="number"], input[type="email"] {
            width: 3cm;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #ffffff;
            color: #333333;
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        input[type="number"]:focus, input[type="email"]:focus {
            border-color: #00a859;
            box-shadow: 0 0 5px rgba(0, 168, 89, 0.5);
            outline: none;
        }
        button {
            width: 200px;
            padding: 14px;
            background: #00a859; /* SPP green */
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 400;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
        }
        button:hover {
            background: #008f4a; /* Darker green */
            transform: translateY(-3px);
        }
        button:active {
            transform: translateY(0);
        }
        .output-field {
            margin: 25px 0;
            padding: 20px;
            background: rgba(0, 168, 89, 0.05); /* Light green tint */
            border-radius: 10px;
            transition: opacity 0.3s;
        }
        .output-field label {
            font-weight: 700;
            color: #00a859;
        }
        #email-section {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 168, 89, 0.05);
            border-radius: 10px;
        }
        #email-section input[type="email"] {
            width: 100%;
            max-width: 300px;
            margin: 10px 0;
        }
        .disclaimer {
            font-size: 0.9rem;
            color: #666666;
            text-align: center;
            margin: 40px 0;
            padding: 0 20px;
            max-width: 800px;
            line-height: 1.5;
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 1.5rem;
                margin: 30px 0 15px;
            }
            .container {
                width: 90%;
                padding: 15px;
            }
            th, td {
                padding: 10px;
            }
            button {
                width: 150px;
            }
        }
    </style>
</head>
<body>
<h1>Unternehmensbewertung</h1>

<div class="container">
    <form id="valuationForm">
        <table>
            <thead>
                <tr>
                    <th>Posten</th>
                    <th>2023</th>
                    <th>2024</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Umsatz (Revenue)</td><td><input type="number" id="revenue2023" name="revenue2023"></td><td><input type="number" id="revenue2024" name="revenue2024"></td></tr>
                <tr><td>Materialaufwand</td><td><input type="number" id="materialaufwand2023" name="materialaufwand2023"></td><td><input type="number" id="materialaufwand2024" name="materialaufwand2024"></td></tr>
                <tr><td>Personalaufwand</td><td><input type="number" id="personalaufwand2023" name="personalaufwand2023"></td><td><input type="number" id="personalaufwand2024" name="personalaufwand2024"></td></tr>
                <tr><td>Weiterbildungsaufwand</td><td><input type="number" id="weiterbildungsaufwand2023" name="weiterbildungsaufwand2023"></td><td><input type="number" id="weiterbildungsaufwand2024" name="weiterbildungsaufwand2024"></td></tr>
                <tr><td>Raumkosten, Miete</td><td><input type="number" id="raumkosten2023" name="raumkosten2023"></td><td><input type="number" id="raumkosten2024" name="raumkosten2024"></td></tr>
                <tr><td>Energie und Entsorgung</td><td><input type="number" id="energieEntsorgung2023" name="energieEntsorgung2023"></td><td><input type="number" id="energieEntsorgung2024" name="energieEntsorgung2024"></td></tr>
                <tr><td>Unterhalt, Rep., Ersatz</td><td><input type="number" id="unterhaltRepErsatz2023" name="unterhaltRepErsatz2023"></td><td><input type="number" id="unterhaltRepErsatz2024" name="unterhaltRepErsatz2024"></td></tr>
                <tr><td>U+R Fahrzeuge</td><td><input type="number" id="uRfahrzeuge2023" name="uRfahrzeuge2023"></td><td><input type="number" id="uRfahrzeuge2024" name="uRfahrzeuge2024"></td></tr>
                <tr><td>Leasingkosten</td><td><input type="number" id="leasingkosten2023" name="leasingkosten2023"></td><td><input type="number" id="leasingkosten2024" name="leasingkosten2024"></td></tr>
                <tr><td>Sachversicherungen</td><td><input type="number" id="sachversicherungen2023" name="sachversicherungen2023"></td><td><input type="number" id="sachversicherungen2024" name="sachversicherungen2024"></td></tr>
                <tr><td>Büro- und Verwaltungskosten</td><td><input type="number" id="bueroVerwaltungskosten2023" name="bueroVerwaltungskosten2023"></td><td><input type="number" id="bueroVerwaltungskosten2024" name="bueroVerwaltungskosten2024"></td></tr>
                <tr><td>Beraterhonorare</td><td><input type="number" id="beraterhonorare2023" name="beraterhonorare2023"></td><td><input type="number" id="beraterhonorare2024" name="beraterhonorare2024"></td></tr>
                <tr><td>Werbung/Fachliteratur/Marketing</td><td><input type="number" id="werbungMarketing2023" name="werbungMarketing2023"></td><td><input type="number" id="werbungMarketing2024" name="werbungMarketing2024"></td></tr>
                <tr><td>Reise + Repräsentationskosten</td><td><input type="number" id="reiseRepKosten2023" name="reiseRepKosten2023"></td><td><input type="number" id="reiseRepKosten2024" name="reiseRepKosten2024"></td></tr>
                <tr><td>Sonstige operative Kosten</td><td><input type="number" id="sonstigeOperativeKosten2023" name="sonstigeOperativeKosten2023"></td><td><input type="number" id="sonstigeOperativeKosten2024" name="sonstigeOperativeKosten2024"></td></tr>
                <tr><td>Sonstiger Ertrag</td><td><input type="number" id="sonstigerErtrag2023" name="sonstigerErtrag2023"></td><td><input type="number" id="sonstigerErtrag2024" name="sonstigerErtrag2024"></td></tr>
                <tr><td>Unternehmerlohn</td><td><input type="number" id="unternehmerlohn2023" name="unternehmerlohn2023"></td><td><input type="number" id="unternehmerlohn2024" name="unternehmerlohn2024"></td></tr>
            </tbody>
        </table>

        <button type="button" onclick="calculate()">Berechnen</button>

        <div id="output-section" style="display:none;">
            <div class="output-field">
                <label for="companyValue2024">Unternehmenswert 2024 (Range):</label>
                <p id="companyValue2024"></p>
            </div>
            <div class="output-field">
                <p id="message"></p>
            </div>
            <div id="email-section">
                <p>Würden Sie gerne mehr erfahren, sehr gerne melden wir uns bei Ihnen, wenn Sie uns Ihre Emailaddresse geben:</p>
                <input type="email" id="userEmail" placeholder="Ihre Email-Adresse">
                <button type="button" onclick="submitEmail()">Absenden</button>
            </div>
        </div>
    </form>
</div>

<div class="disclaimer">
    Hinweis: Jede Haftung wird abgelehnt. Die hier dargestellten Berechnungen dienen ausschließlich illustrativen und Unterhaltungszwecken und stellen keine rechtliche, finanzielle oder sonstige Beratung dar.
</div>

<script>
    function getMultipleRange(ebitda) {
        if (ebitda < 200000) {
            return { multiples: null, message: "Praxis ist leider zu klein für eine automatisches Gutachten, bitte wenden Sie sich Ihren Treuhandexperten" };
        } else if (ebitda >= 200000 && ebitda < 350000) {
            return { multiples: [2.5, 3.5], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns:" };
        } else if (ebitda >= 350000 && ebitda < 600000) {
            return { multiples: [2.75, 4.0], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns:" };
        } else if (ebitda >= 600000 && ebitda < 1200000) {
            return { multiples: [3.0, 4.25], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns:" };
        } else if (ebitda >= 1200000) {
            return { multiples: null, message: "Aufgrund der Grösse der Praxis muss dies individuell beurteilt werden, gerne sprechen wir mit Ihnen dazu:" };
        }
    }

    let currentOutput = {};

    function calculate() {
        try {
            const revenue2024 = parseFloat(document.getElementById('revenue2024').value) || 0;
            const materialaufwand2024 = Math.abs(parseFloat(document.getElementById('materialaufwand2024').value) || 0);
            const personalaufwand2024 = Math.abs(parseFloat(document.getElementById('personalaufwand2024').value) || 0);
            const weiterbildungsaufwand2024 = Math.abs(parseFloat(document.getElementById('weiterbildungsaufwand2024').value) || 0);
            const raumkosten2024 = Math.abs(parseFloat(document.getElementById('raumkosten2024').value) || 0);
            const energieEntsorgung2024 = Math.abs(parseFloat(document.getElementById('energieEntsorgung2024').value) || 0);
            const unterhaltRepErsatz2024 = Math.abs(parseFloat(document.getElementById('unterhaltRepErsatz2024').value) || 0);
            const uRfahrzeuge2024 = Math.abs(parseFloat(document.getElementById('uRfahrzeuge2024').value) || 0);
            const leasingkosten2024 = Math.abs(parseFloat(document.getElementById('leasingkosten2024').value) || 0);
            const sachversicherungen2024 = Math.abs(parseFloat(document.getElementById('sachversicherungen2024').value) || 0);
            const bueroVerwaltungskosten2024 = Math.abs(parseFloat(document.getElementById('bueroVerwaltungskosten2024').value) || 0);
            const beraterhonorare2024 = Math.abs(parseFloat(document.getElementById('beraterhonorare2024').value) || 0);
            const werbungMarketing2024 = Math.abs(parseFloat(document.getElementById('werbungMarketing2024').value) || 0);
            const reiseRepKosten2024 = Math.abs(parseFloat(document.getElementById('reiseRepKosten2024').value) || 0);
            const sonstigeOperativeKosten2024 = Math.abs(parseFloat(document.getElementById('sonstigeOperativeKosten2024').value) || 0);
            const sonstigerErtrag2024 = parseFloat(document.getElementById('sonstigerErtrag2024').value) || 0;
            const unternehmerlohn2024 = Math.abs(parseFloat(document.getElementById('unternehmerlohn2024').value) || 0);

            // EBITDA: Revenue + Other Income - Absolute Costs
            const ebitda2024 = revenue2024 + sonstigerErtrag2024 - (
                materialaufwand2024 + personalaufwand2024 + weiterbildungsaufwand2024 +
                raumkosten2024 + energieEntsorgung2024 + unterhaltRepErsatz2024 +
                uRfahrzeuge2024 + leasingkosten2024 + sachversicherungen2024 +
                bueroVerwaltungskosten2024 + beraterhonorare2024 + werbungMarketing2024 +
                reiseRepKosten2024 + sonstigeOperativeKosten2024 + unternehmerlohn2024
            );

            const result = getMultipleRange(ebitda2024);
            const multiples = result.multiples;
            const message = result.message;

            const companyValueOutput = document.getElementById('companyValue2024');
            const messageOutput = document.getElementById('message');
            const emailSection = document.getElementById('email-section');

            let companyValueLow, companyValueHigh;
            if (multiples) {
                companyValueLow = ebitda2024 * multiples[0];
                companyValueHigh = ebitda2024 * multiples[1];
                companyValueOutput.innerText = `${companyValueLow.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })} - ${companyValueHigh.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            } else {
                companyValueLow = companyValueHigh = null;
                companyValueOutput.innerText = '';
            }

            messageOutput.innerText = `${message}\nEBITDA 2024: ${ebitda2024.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            document.getElementById('output-section').style.display = 'block';

            emailSection.style.display = (companyValueLow && companyValueLow > 200000) ? 'block' : 'none';

            currentOutput = {
                ebitda2024: ebitda2024.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 }),
                companyValue: multiples ? `${companyValueLow.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })} - ${companyValueHigh.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}` : 'N/A',
                message: message
            };
        } catch (error) {
            console.error('Error in calculate:', error);
            document.getElementById('message').innerText = 'Ein Fehler ist aufgetreten. Bitte überprüfen Sie Ihre Eingaben.';
            document.getElementById('output-section').style.display = 'block';
        }
    }

    function submitEmail() {
        const userEmail = document.getElementById('userEmail').value;
        if (!userEmail) {
            alert('Bitte geben Sie eine gültige Email-Adresse ein.');
            return;
        }

        const subject = encodeURIComponent('Unternehmensbewertung Ergebnis');
        const body = encodeURIComponent(
            `Benutzer-Email: ${userEmail}\n` +
            `EBITDA 2024: ${currentOutput.ebitda2024}\n` +
            `Unternehmenswert 2024: ${currentOutput.companyValue}\n` +
            `Nachricht: ${currentOutput.message}`
        );

        window.location.href = `mailto:christian.schmid@spp.ch?subject=${subject}&body=${body}`;
        alert('Ihre Anfrage wurde simuliert. In einer echten Anwendung würde dies an christian.schmid@spp.ch gesendet.');
    }
</script>
</body>
</html>
