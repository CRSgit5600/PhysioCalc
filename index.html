<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unternehmensbewertung</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #ffffff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin: 40px 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #e82127; /* Tesla red */
        }
        form {
            width: 90%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        th {
            text-align: left;
            font-weight: 400;
            color: #cccccc;
        }
        input[type="number"], input[type="email"] {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            font-size: 1rem;
            transition: background 0.3s;
        }
        input[type="number"]:focus, input[type="email"]:focus {
            background: rgba(255, 255, 255, 0.2);
            outline: none;
        }
        button {
            padding: 12px 24px;
            background: #e82127;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 400;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
        }
        button:hover {
            background: #c71d23;
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        .output-field {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        .output-field label {
            font-weight: 700;
            color: #e82127;
        }
        #email-section {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        #email-section input[type="email"] {
            margin: 10px 0;
            width: calc(100% - 16px);
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }
            form {
                width: 95%;
                padding: 10px;
            }
            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
<h1>Unternehmensbewertung für Physiotherapie-Praxis</h1>

<form id="valuationForm">
    <table>
        <thead>
            <tr>
                <th>Posten</th>
                <th>2023</th>
                <th>2024</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>Umsatz (Revenue)</td><td><input type="number" id="revenue2023" name="revenue2023"></td><td><input type="number" id="revenue2024" name="revenue2024"></td></tr>
            <tr><td>Materialaufwand</td><td><input type="number" id="materialaufwand2023" name="materialaufwand2023"></td><td><input type="number" id="materialaufwand2024" name="materialaufwand2024"></td></tr>
            <tr><td>Personalaufwand</td><td><input type="number" id="personalaufwand2023" name="personalaufwand2023"></td><td><input type="number" id="personalaufwand2024" name="personalaufwand2024"></td></tr>
            <tr><td>Weiterbildungsaufwand</td><td><input type="number" id="weiterbildungsaufwand2023" name="weiterbildungsaufwand2023"></td><td><input type="number" id="weiterbildungsaufwand2024" name="weiterbildungsaufwand2024"></td></tr>
            <tr><td>Raumkosten, Miete</td><td><input type="number" id="raumkosten2023" name="raumkosten2023"></td><td><input type="number" id="raumkosten2024" name="raumkosten2024"></td></tr>
            <tr><td>Energie und Entsorgung</td><td><input type="number" id="energieEntsorgung2023" name="energieEntsorgung2023"></td><td><input type="number" id="energieEntsorgung2024" name="energieEntsorgung2024"></td></tr>
            <tr><td>Unterhalt, Rep., Ersatz</td><td><input type="number" id="unterhaltRepErsatz2023" name="unterhaltRepErsatz2023"></td><td><input type="number" id="unterhaltRepErsatz2024" name="unterhaltRepErsatz2024"></td></tr>
            <tr><td>U+R Fahrzeuge</td><td><input type="number" id="uRfahrzeuge2023" name="uRfahrzeuge2023"></td><td><input type="number" id="uRfahrzeuge2024" name="uRfahrzeuge2024"></td></tr>
            <tr><td>Leasingkosten</td><td><input type="number" id="leasingkosten2023" name="leasingkosten2023"></td><td><input type="number" id="leasingkosten2024" name="leasingkosten2024"></td></tr>
            <tr><td>Sachversicherungen</td><td><input type="number" id="sachversicherungen2023" name="sachversicherungen2023"></td><td><input type="number" id="sachversicherungen2024" name="sachversicherungen2024"></td></tr>
            <tr><td>Büro- und Verwaltungskosten</td><td><input type="number" id="bueroVerwaltungskosten2023" name="bueroVerwaltungskosten2023"></td><td><input type="number" id="bueroVerwaltungskosten2024" name="bueroVerwaltungskosten2024"></td></tr>
            <tr><td>Beraterhonorare</td><td><input type="number" id="beraterhonorare2023" name="beraterhonorare2023"></td><td><input type="number" id="beraterhonorare2024" name="beraterhonorare2024"></td></tr>
            <tr><td>Werbung/Fachliteratur/Marketing</td><td><input type="number" id="werbungMarketing2023" name="werbungMarketing2023"></td><td><input type="number" id="werbungMarketing2024" name="werbungMarketing2024"></td></tr>
            <tr><td>Reise + Repräsentationskosten</td><td><input type="number" id="reiseRepKosten2023" name="reiseRepKosten2023"></td><td><input type="number" id="reiseRepKosten2024" name="reiseRepKosten2024"></td></tr>
            <tr><td>Sonstige operative Kosten</td><td><input type="number" id="sonstigeOperativeKosten2023" name="sonstigeOperativeKosten2023"></td><td><input type="number" id="sonstigeOperativeKosten2024" name="sonstigeOperativeKosten2024"></td></tr>
            <tr><td>Sonstiger Ertrag</td><td><input type="number" id="sonstigerErtrag2023" name="sonstigerErtrag2023"></td><td><input type="number" id="sonstigerErtrag2024" name="sonstigerErtrag2024"></td></tr>
            <tr><td>Unternehmerlohn</td><td><input type="number" id="unternehmerlohn2023" name="unternehmerlohn2023"></td><td><input type="number" id="unternehmerlohn2024" name="unternehmerlohn2024"></td></tr>
        </tbody>
    </table>

    <button type="button" onclick="calculate()">Berechnen</button>

    <div id="output-section" style="display:none;">
        <div class="output-field">
            <label for="companyValue2024">Unternehmenswert 2024 (Range):</label>
            <p id="companyValue2024"></p>
        </div>
        <div class="output-field">
            <p id="message"></p>
        </div>
        <div id="email-section">
            <p>Würden Sie gerne mehr erfahren, sehr gerne melden wir uns bei Ihnen, wenn Sie uns Ihre Emailaddresse geben:</p>
            <input type="email" id="userEmail" placeholder="Ihre Email-Adresse">
            <button type="button" onclick="submitEmail()">Absenden</button>
        </div>
    </div>
</form>

<script>
    function getMultipleRange(ebitda) {
        console.log('EBITDA:', ebitda);
        if (ebitda < 200000) {
            return { multiples: null, message: "Praxis ist leider zu klein für eine automatisches Gutachten, bitte wenden Sie sich Ihren Treuhandexperten" };
        } else if (ebitda >= 200000 && ebitda < 350000) {
            return { multiples: [2.5, 3.5], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns:" };
        } else if (ebitda >= 350000 && ebitda < 600000) {
            return { multiples: [2.75, 4.0], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns:" };
        } else if (ebitda >= 600000 && ebitda < 1200000) {
            return { multiples: [3.0, 4.25], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns:" };
        } else if (ebitda >= 1200000) {
            return { multiples: null, message: "Aufgrund der Grösse der Praxis muss dies individuell beurteilt werden, gerne sprechen wir mit Ihnen dazu:" };
        }
    }

    let currentOutput = {};

    function calculate() {
        console.log('Calculate function triggered');
        try {
            const revenue2024 = parseFloat(document.getElementById('revenue2024').value) || 0;
            const materialaufwand2024 = parseFloat(document.getElementById('materialaufwand2024').value) || 0;
            const personalaufwand2024 = parseFloat(document.getElementById('personalaufwand2024').value) || 0;
            const weiterbildungsaufwand2024 = parseFloat(document.getElementById('weiterbildungsaufwand2024').value) || 0;
            const raumkosten2024 = parseFloat(document.getElementById('raumkosten2024').value) || 0;
            const energieEntsorgung2024 = parseFloat(document.getElementById('energieEntsorgung2024').value) || 0;
            const unterhaltRepErsatz2024 = parseFloat(document.getElementById('unterhaltRepErsatz2024').value) || 0;
            const uRfahrzeuge2024 = parseFloat(document.getElementById('uRfahrzeuge2024').value) || 0;
            const leasingkosten2024 = parseFloat(document.getElementById('leasingkosten2024').value) || 0;
            const sachversicherungen2024 = parseFloat(document.getElementById('sachversicherungen2024').value) || 0;
            const bueroVerwaltungskosten2024 = parseFloat(document.getElementById('bueroVerwaltungskosten2024').value) || 0;
            const beraterhonorare2024 = parseFloat(document.getElementById('beraterhonorare2024').value) || 0;
            const werbungMarketing2024 = parseFloat(document.getElementById('werbungMarketing2024').value) || 0;
            const reiseRepKosten2024 = parseFloat(document.getElementById('reiseRepKosten2024').value) || 0;
            const sonstigeOperativeKosten2024 = parseFloat(document.getElementById('sonstigeOperativeKosten2024').value) || 0;
            const sonstigerErtrag2024 = parseFloat(document.getElementById('sonstigerErtrag2024').value) || 0;
            const unternehmerlohn2024 = parseFloat(document.getElementById('unternehmerlohn2024').value) || 0;

            const ebitda2024 = revenue2024 + sonstigerErtrag2024 - (
                materialaufwand2024 + personalaufwand2024 + weiterbildungsaufwand2024 +
                raumkosten2024 + energieEntsorgung2024 + unterhaltRepErsatz2024 +
                uRfahrzeuge2024 + leasingkosten2024 + sachversicherungen2024 +
                bueroVerwaltungskosten2024 + beraterhonorare2024 + werbungMarketing2024 +
                reiseRepKosten2024 + sonstigeOperativeKosten2024 + unternehmerlohn2024
            );

            const result = getMultipleRange(ebitda2024);
            const multiples = result.multiples;
            const message = result.message;

            const companyValueOutput = document.getElementById('companyValue2024');
            const messageOutput = document.getElementById('message');
            const emailSection = document.getElementById('email-section');

            let companyValueLow, companyValueHigh;
            if (multiples) {
                companyValueLow = ebitda2024 * multiples[0];
                companyValueHigh = ebitda2024 * multiples[1];
                companyValueOutput.innerText = `${companyValueLow.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })} - ${companyValueHigh.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            } else {
                companyValueLow = companyValueHigh = null;
                companyValueOutput.innerText = '';
            }

            messageOutput.innerText = `${message}\nEBITDA 2024: ${ebitda2024.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            document.getElementById('output-section').style.display = 'block';

            emailSection.style.display = (companyValueLow && companyValueLow > 200000) ? 'block' : 'none';

            currentOutput = {
                ebitda2024: ebitda2024.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 }),
                companyValue: multiples ? `${companyValueLow.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })} - ${companyValueHigh.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}` : 'N/A',
                message: message
            };

            console.log('Calculation complete:', currentOutput);
        } catch (error) {
            console.error('Error in calculate:', error);
            document.getElementById('message').innerText = 'Ein Fehler ist aufgetreten. Bitte überprüfen Sie Ihre Eingaben.';
            document.getElementById('output-section').style.display = 'block';
        }
    }

    function submitEmail() {
        console.log('Submit email triggered');
        const userEmail = document.getElementById('userEmail').value;
        if (!userEmail) {
            alert('Bitte geben Sie eine gültige Email-Adresse ein.');
            return;
        }

        const subject = encodeURIComponent('Unternehmensbewertung Ergebnis');
        const body = encodeURIComponent(
            `Benutzer-Email: ${userEmail}\n` +
            `EBITDA 2024: ${currentOutput.ebitda2024}\n` +
            `Unternehmenswert 2024: ${currentOutput.companyValue}\n` +
            `Nachricht: ${currentOutput.message}`
        );

        window.location.href = `mailto:christian.schmid@spp.ch?subject=${subject}&body=${body}`;
        alert('Ihre Anfrage wurde simuliert. In einer echten Anwendung würde dies an christian.schmid@spp.ch gesendet.');
    }
</script>
</body>
</html>
