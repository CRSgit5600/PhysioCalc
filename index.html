<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Unternehmensbewertung für PhysioPraxen</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #ffffff 100%);
            color: #333333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }
        h1 {
            font-size: 1.5rem;
            font-weight: 300;
            margin: 2rem 0 1rem;
            text-transform: uppercase;
            letter-spacing: 0.125rem;
            color: #00a859;
            text-shadow: 0 1px 5px rgba(0, 168, 89, 0.2);
        }
        .intro-text {
            font-size: 1rem;
            margin: 0 0 1rem 0;
            text-align: center;
            padding: 0 1rem;
        }
        .container {
            width: 95%;
            max-width: 1000px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        th, td {
            padding: 0.875rem;
            text-align: right;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            font-size: 1rem;
            vertical-align: middle;
        }
        table thead th {
            font-weight: 400;
            color: #666666;
            text-align: right !important;
        }
        input[type="number"], input[type="email"] {
            width: 3cm;
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 0.5rem;
            background: #ffffff;
            color: #333333;
            font-size: 0.9rem;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-sizing: border-box;
        }
        input[type="number"]:focus, input[type="email"]:focus {
            border-color: #00a859;
            box-shadow: 0 0 5px rgba(0, 168, 89, 0.5);
            outline: none;
        }
        button {
            width: 200px;
            padding: 0.875rem;
            background: #00a859;
            color: #ffffff;
            border: none;
            border-radius: 0.5rem;
            font-size: 1.1rem;
            font-weight: 400;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
            margin: 1rem auto;
            display: block;
        }
        button:hover {
            background: #008f4a;
            transform: translateY(-3px);
        }
        button:active {
            transform: translateY(0);
        }
        .output-field {
            margin: 1.5rem 0;
            padding: 1.25rem;
            background: rgba(0, 168, 89, 0.05);
            border-radius: 0.625rem;
            font-size: 1rem;
        }
        .output-field label {
            font-weight: 700;
            color: #00a859;
        }
        #email-section {
            display: none;
            margin-top: 1.25rem;
            padding: 1.25rem;
            background: rgba(0, 168, 89, 0.05);
            border-radius: 0.625rem;
            font-size: 1rem;
        }
        #email-section input[type="email"] {
            width: 100%;
            max-width: 18.75rem;
            margin: 0.625rem 0;
        }
        .disclaimer {
            font-size: 0.9rem;
            color: #666666;
            text-align: center;
            margin: 2.5rem 0;
            padding: 0 1.25rem;
            max-width: 50rem;
            line-height: 1.5;
        }
        @media (max-width: 480px) {
            h1 {
                font-size: 1.2rem;
                margin: 1.5rem 0 0.75rem;
            }
            .intro-text {
                font-size: 0.85rem;
                margin: 0 0 0.75rem 0;
            }
            .container {
                width: 100%;
                padding: 0.75rem;
                overflow-y: auto;
                max-height: calc(100vh - 6rem);
            }
            th, td {
                padding: 0.25rem;
                font-size: 0.75rem;
            }
            input[type="number"] {
                width: 2.5rem;
                padding: 0.25rem;
                font-size: 0.65rem;
            }
            button {
                width: 120px;
                padding: 0.5rem;
                font-size: 0.9rem;
            }
            .output-field {
                margin: 1rem 0;
                padding: 0.75rem;
                font-size: 0.75rem;
            }
            #email-section {
                margin-top: 0.75rem;
                padding: 0.75rem;
                font-size: 0.75rem;
            }
            #email-section input[type="email"] {
                max-width: 100%;
                padding: 0.25rem;
                font-size: 0.65rem;
            }
            .disclaimer {
                font-size: 0.7rem;
                margin: 1.5rem 0;
                padding: 0 0.75rem;
            }
        }
    </style>
</head>
<body>
<h1>Unternehmensbewertung für PhysioPraxen</h1>

<div class="intro-text">
    Würden Sie gerne erfahren, was Ihre Praxis wert sein könnte? Der untenstehende Rechner hilft Ihnen.
</div>

<div class="container">
    <form id="valuationForm">
        <table>
            <thead>
                <tr>
                    <th>Posten</th>
                    <th>2023</th>
                    <th>2024</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Umsatz</td><td><input type="number" id="revenue2023" name="revenue2023"></td><td><input type="number" id="revenue2024" name="revenue2024"></td></tr>
                <tr><td>Materialaufwand</td><td><input type="number" id="materialaufwand2023" name="materialaufwand2023"></td><td><input type="number" id="materialaufwand2024" name="materialaufwand2024"></td></tr>
                <tr><td>Personalaufwand</td><td><input type="number" id="personalaufwand2023" name="personalaufwand2023"></td><td><input type="number" id="personalaufwand2024" name="personalaufwand2024"></td></tr>
                <tr><td>Weiterbildungsaufwand</td><td><input type="number" id="weiterbildungsaufwand2023" name="weiterbildungsaufwand2023"></td><td><input type="number" id="weiterbildungsaufwand2024" name="weiterbildungsaufwand2024"></td></tr>
                <tr><td>Raumkosten, Miete</td><td><input type="number" id="raumkosten2023" name="raumkosten2023"></td><td><input type="number" id="raumkosten2024" name="raumkosten2024"></td></tr>
                <tr><td>Energie und Entsorgung</td><td><input type="number" id="energieEntsorgung2023" name="energieEntsorgung2023"></td><td><input type="number" id="energieEntsorgung2024" name="energieEntsorgung2024"></td></tr>
                <tr><td>Unterhalt, Reparatur und Ersatz</td><td><input type="number" id="unterhaltRepErsatz2023" name="unterhaltRepErsatz2023"></td><td><input type="number" id="unterhaltRepErsatz2024" name="unterhaltRepErsatz2024"></td></tr>
                <tr><td>Fahrzeugaufwand</td><td><input type="number" id="uRfahrzeuge2023" name="uRfahrzeuge2023"></td><td><input type="number" id="uRfahrzeuge2024" name="uRfahrzeuge2024"></td></tr>
                <tr><td>Leasingkosten</td><td><input type="number" id="leasingkosten2023" name="leasingkosten2023"></td><td><input type="number" id="leasingkosten2024" name="leasingkosten2024"></td></tr>
                <tr><td>Sachversicherungen</td><td><input type="number" id="sachversicherungen2023" name="sachversicherungen2023"></td><td><input type="number" id="sachversicherungen2024" name="sachversicherungen2024"></td></tr>
                <tr><td>Büro- und Verwaltungskosten</td><td><input type="number" id="bueroVerwaltungskosten2023" name="bueroVerwaltungskosten2023"></td><td><input type="number" id="bueroVerwaltungskosten2024" name="bueroVerwaltungskosten2024"></td></tr>
                <tr><td>Beraterhonorare</td><td><input type="number" id="beraterhonorare2023" name="beraterhonorare2023"></td><td><input type="number" id="beraterhonorare2024" name="beraterhonorare2024"></td></tr>
                <tr><td>Werbung/Fachliteratur/Marketing</td><td><input type="number" id="werbungMarketing2023" name="werbungMarketing2023"></td><td><input type="number" id="werbungMarketing2024" name="werbungMarketing2024"></td></tr>
                <tr><td>Reise und Repräsentationskosten</td><td><input type="number" id="reiseRepKosten2023" name="reiseRepKosten2023"></td><td><input type="number" id="reiseRepKosten2024" name="reiseRepKosten2024"></td></tr>
                <tr><td>Sonstige operative Kosten</td><td><input type="number" id="sonstigeOperativeKosten2023" name="sonstigeOperativeKosten2023"></td><td><input type="number" id="sonstigeOperativeKosten2024" name="sonstigeOperativeKosten2024"></td></tr>
                <tr><td>Sonstiger Ertrag</td><td><input type="number" id="sonstigerErtrag2023" name="sonstigerErtrag2023"></td><td><input type="number" id="sonstigerErtrag2024" name="sonstigerErtrag2024"></td></tr>
                <tr><td>Unternehmerlohn (Sofern nicht in Personalkosten)</td><td><input type="number" id="unternehmerlohn2023" name="unternehmerlohn2023"></td><td><input type="number" id="unternehmerlohn2024" name="unternehmerlohn2024"></td></tr>
            </tbody>
        </table>

        <button type="button" onclick="calculate()">Berechnen</button>

        <div id="output-section" style="display:none;">
            <div class="output-field">
                <label for="companyValue2024">Unternehmenswert 2024 (Bandbreite):</label>
                <p id="companyValue2024"></p>
            </div>
            <div class="output-field">
                <p id="message"></p>
            </div>
            <div id="email-section">
                <p>Würden Sie gerne mehr erfahren, sehr gerne melden wir uns bei Ihnen, wenn Sie uns Ihre Emailadresse geben:</p>
                <input type="email" id="userEmail" placeholder="Ihre Email-Adresse">
                <button type="button" onclick="submitEmail()">Absenden</button>
            </div>
        </div>
    </form>
</div>

<div class="disclaimer">
    Hinweis: Jede Haftung wird abgelehnt. Die hier dargestellten Berechnungen dienen ausschliesslich illustrativen und Unterhaltungszwecken und stellen keine rechtliche, finanzielle oder sonstige Beratung dar.
</div>

<script>
    // Format number with Swiss thousand separator
    function formatNumberWithSeparator(value) {
        return value.toLocaleString('de-CH', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
    }

    // Add thousand separator to input fields on blur (not input)
    document.querySelectorAll('input[type="number"]').forEach(input => {
        input.addEventListener('blur', function() {
            const value = parseFloat(this.value.replace(/’/g, ''));
            if (!isNaN(value)) {
                this.value = formatNumberWithSeparator(value);
            }
        });
        // Prevent interference during typing
        input.addEventListener('input', function() {
            // Remove separators temporarily while typing
            const rawValue = this.value.replace(/’/g, '');
            if (!isNaN(parseFloat(rawValue))) {
                this.dataset.rawValue = rawValue; // Store raw value for calculation
            }
        });
    });

    function getMultipleRange(ebitda) {
        if (ebitda < 200000) {
            return { multiples: null, message: "Praxis ist leider zu klein für ein automatisches Gutachten, bitte wenden Sie sich an Ihren Treuhandexperten" };
        } else if (ebitda >= 200000 && ebitda < 350000) {
            return { multiples: [2.5, 3.5], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns!" };
        } else if (ebitda >= 350000 && ebitda < 600000) {
            return { multiples: [2.75, 4.0], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns!" };
        } else if (ebitda >= 600000 && ebitda < 1200000) {
            return { multiples: [3.0, 4.25], message: "Basierend auf einer ersten Einschätzung könnte Ihre Praxis den folgenden Unternehmenswert aufweisen. Wenn Sie mehr erfahren wollen kontaktieren Sie uns!" };
        } else if (ebitda >= 1200000) {
            return { multiples: null, message: "Aufgrund der Grösse der Praxis muss dies individuell beurteilt werden, gerne sprechen wir mit Ihnen dazu:" };
        }
    }

    let currentOutput = {};

    function calculate() {
        try {
            // Get input values for 2023
            const revenue2023 = parseFloat(document.getElementById('revenue2023').dataset.rawValue || document.getElementById('revenue2023').value.replace(/’/g, '')) || 0;
            const materialaufwand2023 = Math.abs(parseFloat(document.getElementById('materialaufwand2023').dataset.rawValue || document.getElementById('materialaufwand2023').value.replace(/’/g, '')) || 0);
            const personalaufwand2023 = Math.abs(parseFloat(document.getElementById('personalaufwand2023').dataset.rawValue || document.getElementById('personalaufwand2023').value.replace(/’/g, '')) || 0);
            const weiterbildungsaufwand2023 = Math.abs(parseFloat(document.getElementById('weiterbildungsaufwand2023').dataset.rawValue || document.getElementById('weiterbildungsaufwand2023').value.replace(/’/g, '')) || 0);
            const raumkosten2023 = Math.abs(parseFloat(document.getElementById('raumkosten2023').dataset.rawValue || document.getElementById('raumkosten2023').value.replace(/’/g, '')) || 0);
            const energieEntsorgung2023 = Math.abs(parseFloat(document.getElementById('energieEntsorgung2023').dataset.rawValue || document.getElementById('energieEntsorgung2023').value.replace(/’/g, '')) || 0);
            const unterhaltRepErsatz2023 = Math.abs(parseFloat(document.getElementById('unterhaltRepErsatz2023').dataset.rawValue || document.getElementById('unterhaltRepErsatz2023').value.replace(/’/g, '')) || 0);
            const uRfahrzeuge2023 = Math.abs(parseFloat(document.getElementById('uRfahrzeuge2023').dataset.rawValue || document.getElementById('uRfahrzeuge2023').value.replace(/’/g, '')) || 0);
            const leasingkosten2023 = Math.abs(parseFloat(document.getElementById('leasingkosten2023').dataset.rawValue || document.getElementById('leasingkosten2023').value.replace(/’/g, '')) || 0);
            const sachversicherungen2023 = Math.abs(parseFloat(document.getElementById('sachversicherungen2023').dataset.rawValue || document.getElementById('sachversicherungen2023').value.replace(/’/g, '')) || 0);
            const bueroVerwaltungskosten2023 = Math.abs(parseFloat(document.getElementById('bueroVerwaltungskosten2023').dataset.rawValue || document.getElementById('bueroVerwaltungskosten2023').value.replace(/’/g, '')) || 0);
            const beraterhonorare2023 = Math.abs(parseFloat(document.getElementById('beraterhonorare2023').dataset.rawValue || document.getElementById('beraterhonorare2023').value.replace(/’/g, '')) || 0);
            const werbungMarketing2023 = Math.abs(parseFloat(document.getElementById('werbungMarketing2023').dataset.rawValue || document.getElementById('werbungMarketing2023').value.replace(/’/g, '')) || 0);
            const reiseRepKosten2023 = Math.abs(parseFloat(document.getElementById('reiseRepKosten2023').dataset.rawValue || document.getElementById('reiseRepKosten2023').value.replace(/’/g, '')) || 0);
            const sonstigeOperativeKosten2023 = Math.abs(parseFloat(document.getElementById('sonstigeOperativeKosten2023').dataset.rawValue || document.getElementById('sonstigeOperativeKosten2023').value.replace(/’/g, '')) || 0);
            const sonstigerErtrag2023 = parseFloat(document.getElementById('sonstigerErtrag2023').dataset.rawValue || document.getElementById('sonstigerErtrag2023').value.replace(/’/g, '')) || 0;
            const unternehmerlohn2023 = Math.abs(parseFloat(document.getElementById('unternehmerlohn2023').dataset.rawValue || document.getElementById('unternehmerlohn2023').value.replace(/’/g, '')) || 0);

            // Get input values for 2024
            const revenue2024 = parseFloat(document.getElementById('revenue2024').dataset.rawValue || document.getElementById('revenue2024').value.replace(/’/g, '')) || 0;
            const materialaufwand2024 = Math.abs(parseFloat(document.getElementById('materialaufwand2024').dataset.rawValue || document.getElementById('materialaufwand2024').value.replace(/’/g, '')) || 0);
            const personalaufwand2024 = Math.abs(parseFloat(document.getElementById('personalaufwand2024').dataset.rawValue || document.getElementById('personalaufwand2024').value.replace(/’/g, '')) || 0);
            const weiterbildungsaufwand2024 = Math.abs(parseFloat(document.getElementById('weiterbildungsaufwand2024').dataset.rawValue || document.getElementById('weiterbildungsaufwand2024').value.replace(/’/g, '')) || 0);
            const raumkosten2024 = Math.abs(parseFloat(document.getElementById('raumkosten2024').dataset.rawValue || document.getElementById('raumkosten2024').value.replace(/’/g, '')) || 0);
            const energieEntsorgung2024 = Math.abs(parseFloat(document.getElementById('energieEntsorgung2024').dataset.rawValue || document.getElementById('energieEntsorgung2024').value.replace(/’/g, '')) || 0);
            const unterhaltRepErsatz2024 = Math.abs(parseFloat(document.getElementById('unterhaltRepErsatz2024').dataset.rawValue || document.getElementById('unterhaltRepErsatz2024').value.replace(/’/g, '')) || 0);
            const uRfahrzeuge2024 = Math.abs(parseFloat(document.getElementById('uRfahrzeuge2024').dataset.rawValue || document.getElementById('uRfahrzeuge2024').value.replace(/’/g, '')) || 0);
            const leasingkosten2024 = Math.abs(parseFloat(document.getElementById('leasingkosten2024').dataset.rawValue || document.getElementById('leasingkosten2024').value.replace(/’/g, '')) || 0);
            const sachversicherungen2024 = Math.abs(parseFloat(document.getElementById('sachversicherungen2024').dataset.rawValue || document.getElementById('sachversicherungen2024').value.replace(/’/g, '')) || 0);
            const bueroVerwaltungskosten2024 = Math.abs(parseFloat(document.getElementById('bueroVerwaltungskosten2024').dataset.rawValue || document.getElementById('bueroVerwaltungskosten2024').value.replace(/’/g, '')) || 0);
            const beraterhonorare2024 = Math.abs(parseFloat(document.getElementById('beraterhonorare2024').dataset.rawValue || document.getElementById('beraterhonorare2024').value.replace(/’/g, '')) || 0);
            const werbungMarketing2024 = Math.abs(parseFloat(document.getElementById('werbungMarketing2024').dataset.rawValue || document.getElementById('werbungMarketing2024').value.replace(/’/g, '')) || 0);
            const reiseRepKosten2024 = Math.abs(parseFloat(document.getElementById('reiseRepKosten2024').dataset.rawValue || document.getElementById('reiseRepKosten2024').value.replace(/’/g, '')) || 0);
            const sonstigeOperativeKosten2024 = Math.abs(parseFloat(document.getElementById('sonstigeOperativeKosten2024').dataset.rawValue || document.getElementById('sonstigeOperativeKosten2024').value.replace(/’/g, '')) || 0);
            const sonstigerErtrag2024 = parseFloat(document.getElementById('sonstigerErtrag2024').dataset.rawValue || document.getElementById('sonstigerErtrag2024').value.replace(/’/g, '')) || 0;
            const unternehmerlohn2024 = Math.abs(parseFloat(document.getElementById('unternehmerlohn2024').dataset.rawValue || document.getElementById('unternehmerlohn2024').value.replace(/’/g, '')) || 0);

            // Calculate EBITDA for both years
            const ebitda2023 = revenue2023 + sonstigerErtrag2023 - (
                materialaufwand2023 + personalaufwand2023 + weiterbildungsaufwand2023 +
                raumkosten2023 + energieEntsorgung2023 + unterhaltRepErsatz2023 +
                uRfahrzeuge2023 + leasingkosten2023 + sachversicherungen2023 +
                bueroVerwaltungskosten2023 + beraterhonorare2023 + werbungMarketing2023 +
                reiseRepKosten2023 + sonstigeOperativeKosten2023 + unternehmerlohn2023
            );

            const ebitda2024 = revenue2024 + sonstigerErtrag2024 - (
                materialaufwand2024 + personalaufwand2024 + weiterbildungsaufwand2024 +
                raumkosten2024 + energieEntsorgung2024 + unterhaltRepErsatz2024 +
                uRfahrzeuge2024 + leasingkosten2024 + sachversicherungen2024 +
                bueroVerwaltungskosten2024 + beraterhonorare2024 + werbungMarketing2024 +
                reiseRepKosten2024 + sonstigeOperativeKosten2024 + unternehmerlohn2024
            );

            // Choose EBITDA to use (2024 if available, otherwise 2023)
            let ebitdaUsed = ebitda2024;
            let ebitdaYearNote = "EBITDA 2024";
            if (ebitda2024 === 0 && ebitda2023 !== 0) {
                ebitdaUsed = ebitda2023;
                ebitdaYearNote = "EBITDA 2023 (da keine Daten für 2024 vorliegen)";
            }

            const result = getMultipleRange(ebitdaUsed);
            const multiples = result.multiples;
            let message = result.message;

            const companyValueOutput = document.getElementById('companyValue2024');
            const messageOutput = document.getElementById('message');
            const emailSection = document.getElementById('email-section');

            let companyValueLow, companyValueHigh;
            if (multiples) {
                companyValueLow = ebitdaUsed * multiples[0];
                companyValueHigh = ebitdaUsed * multiples[1];
                companyValueOutput.innerText = `${companyValueLow.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })} - ${companyValueHigh.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            } else {
                companyValueLow = companyValueHigh = null;
                companyValueOutput.innerText = '';
            }

            messageOutput.innerText = `${message}\n${ebitdaYearNote}: ${ebitdaUsed.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            document.getElementById('output-section').style.display = 'block';

            emailSection.style.display = (companyValueLow && companyValueLow > 200000) ? 'block' : 'none';

            currentOutput = {
                ebitdaUsed: ebitdaUsed.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 }),
                companyValue: multiples ? `${companyValueLow.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })} - ${companyValueHigh.toLocaleString('de-CH', { style: 'currency', currency: 'CHF', minimumFractionDigits: 0, maximumFractionDigits: 0 })}` : 'N/A',
                message: message,
                ebitdaYearNote: ebitdaYearNote
            };
        } catch (error) {
            console.error('Error in calculate:', error);
            document.getElementById('message').innerText = 'Ein Fehler ist aufgetreten. Bitte überprüfen Sie Ihre Eingaben.';
            document.getElementById('output-section').style.display = 'block';
        }
    }

    function submitEmail() {
        const userEmail = document.getElementById('userEmail').value;
        if (!userEmail) {
            alert('Bitte geben Sie eine gültige Email-Adresse ein.');
            return;
        }

        const subject = encodeURIComponent('Unternehmensbewertung Ergebnis');
        const body = encodeURIComponent(
            `Benutzer-Email: ${userEmail}\n` +
            `${currentOutput.ebitdaYearNote}: ${currentOutput.ebitdaUsed}\n` +
            `Unternehmenswert 2024: ${currentOutput.companyValue}\n` +
            `Nachricht: ${currentOutput.message}`
        );

        window.location.href = `mailto:christian.schmid@spp.ch?subject=${subject}&body=${body}`;
        alert('Ihre Anfrage wurde simuliert. In einer echten Anwendung würde dies an christian.schmid@spp.ch gesendet.');
    }
</script>
</body>
</html>
